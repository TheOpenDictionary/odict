["setup:node"]
run = "yarn install"
sources = ["${MISE_TASK_DIR}/package.json"]
outputs = { auto = true }

["build:node"]
depends = ["setup:node"]
dir = "node"
run = "yarn build:node"

["build:wasm"]
depends = ["setup:node"]
dir = "node"
run = "yarn build:wasm"

["dev:wasm"]
depends = ["build:wasm"]
dir = "node"
run = "yarn dev:wasm"

["upgrade:node"]
run = "yarn up"

["publish:node"]
depends = ["setup:node"]
run = "yarn --filter=\"@odict/node\" npm publish"

["test:node"]
depends = ["setup:node", "build:node"]
run = "yarn --filter=\"@odict/node\" test"

["snapshot:node"]
depends = ["setup:node", "build:node"]
run = "yarn --filter=\"@odict/node\" test -u"

["ci:node"]
depends = ["setup:node"]
run = 'mise x act -- act napi --container-architecture linux/amd64 --bind --job {{arg(name="job_id")}}'
hide = true
