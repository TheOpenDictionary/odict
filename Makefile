
test-all: test-go test-python test-jvm 

# ---------------------------------------------------------------------------- #
#                                    Schema                                    #
# ---------------------------------------------------------------------------- #

schema:
	flatc -g --gen-onefile --go-namespace odict -o ./go schema.fbs

# ---------------------------------------------------------------------------- #
#                                    Library                                   #
# ---------------------------------------------------------------------------- #

OUTPUT=build

test-go:
	go test ./go
	
# ---------------------------------------------------------------------------- #
#                                      CLI                                     #
# ---------------------------------------------------------------------------- #

cli:
	go build -o ${OUTPUT} .

# ---------------------------------------------------------------------------- #
#                                    Python                                    #
# ---------------------------------------------------------------------------- #

test-jvm: cli
	cd jvm && RUNTIME_ENV=test ./gradlew test

# ---------------------------------------------------------------------------- #
#                                    Python                                    #
# ---------------------------------------------------------------------------- #

test-python: cli
	cd python && RUNTIME_ENV=test poetry run pytest ./odict

clean:
	rm -rf setup.py dist build schema/*.go