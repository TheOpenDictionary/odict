
# ---------------------------------------------------------------------------- #
#                                    Schema                                    #
# ---------------------------------------------------------------------------- #

schema:
	flatc -g -o . schema/schema.fbs

# ---------------------------------------------------------------------------- #
#                                    Library                                   #
# ---------------------------------------------------------------------------- #

OUTPUT=build

cgo: schema
	go build -buildmode=c-shared -o ${OUTPUT} ./cgo.go

test:
	go test ./go
	
# ---------------------------------------------------------------------------- #
#                                      CLI                                     #
# ---------------------------------------------------------------------------- #

cli:
	go build -o ${OUTPUT} ./cli

# ---------------------------------------------------------------------------- #
#                                    Python                                    #
# ---------------------------------------------------------------------------- #

python:
	poetry build

pytest: python
	RUNTIME_ENV=test poetry run pytest ./odict

clean:
	rm -rf setup.py dist build schema/*.go