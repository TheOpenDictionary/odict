@install:
	pnpm install

@add +args:
  pnpm add {{args}}

@clean:
  rm -rf coverage dist ../**/*.odict  ../**/*.log

[private]
@dlx +args:
  ./node_modules/.bin/{{args}}
  
@schema:
  flatc --ts -o ./src/__generated__ ../flatbuffers/service.fbs ../flatbuffers/enums.fbs

@check +args="":
  just dlx rome check {{args}} .

@format +args="":
  just dlx rome format {{args}} .

@build: install
  just dlx swc -d dist ./src/*.ts ./src/**/*.ts & \
  just dlx tsc

@test +args="": install && clean
  just ../build
  just dlx tsc
  RUNTIME_ENV=test just dlx jest {{args}}

@publish: build
	pnpm publish
